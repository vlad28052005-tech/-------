<!doctype html>
<html lang="uk">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>–†–æ–∑–∫–ª–∞–¥ ‚Äî 4 –∫—É—Ä—Å, –≥—Ä—É–ø–∞ –í</title>
    <meta name="theme-color" content="#0ea5e9" />
    <style>
         :root {
            --bg: #0b1220;
            --panel: #0e1726;
            --text: #e5eefb;
            --muted: #a9b8d5;
            --accent: #0ea5e9;
            --card: #0f172a;
            --border: #1f2a44;
            --lec: #3b82f6;
            --prac: #facc15;
            --green: #16a34a;
        }
        
        [data-theme="light"] {
            --bg: #f8fafc;
            --panel: #fff;
            --text: #0b1220;
            --muted: #54627a;
            --card: #ffffff;
            --border: #e2e8f0;
        }
        
        * {
            box-sizing: border-box
        }
        
        body {
            margin: 0;
            background: var(--bg);
            color: var(--text);
            font: 15px/1.4 system-ui, -apple-system, "Segoe UI", Roboto, Inter, sans-serif;
        }
        
        .wrap {
            max-width: 1150px;
            margin: 0 auto;
            padding: 12px
        }
        
        .topbar {
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            position: sticky;
            top: 0;
            background: linear-gradient(to bottom, var(--bg) 95%, transparent);
            padding: 10px 0;
            z-index: 30;
        }
        
        .brand {
            font-weight: 800
        }
        
        .btn {
            border: 1px solid var(--border);
            background: var(--panel);
            color: var(--text);
            padding: 8px 12px;
            border-radius: 10px;
            cursor: pointer;
        }
        
        .controls {
            display: flex;
            gap: 8px;
            align-items: center;
            background: var(--panel);
            padding: 6px 10px;
            border-radius: 10px;
            border: 1px solid var(--border)
        }
        
        .grid {
            display: grid;
            gap: 10px
        }
        
        .cards {
            grid-template-columns: repeat(5, 1fr)
        }
        
        .card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 10px;
            display: flex;
            flex-direction: column;
            min-height: 120px;
        }
        
        .day {
            font-weight: 700
        }
        
        .dateSmall {
            font-size: 13px;
            color: var(--muted)
        }
        
        .pair {
            border-radius: 10px;
            padding: 8px;
            margin: 6px 0;
            border: 1px solid rgba(255, 255, 255, 0.03);
        }
        
        .chip {
            font-size: 12px;
            padding: 3px 8px;
            border-radius: 999px
        }
        
        .lec {
            background: var(--lec);
            color: #fff
        }
        
        .prac {
            background: var(--prac);
            color: #000
        }
        
        .card.now {
            outline: 3px solid rgba(14, 165, 233, .85)
        }
        
        .pair.current {
            border: 2px solid rgba(59, 130, 246, .95)
        }
        
        .pair.next {
            border: 2px solid rgba(245, 158, 11, .95);
            position: relative
        }
        
        .pair.next .badge {
            position: absolute;
            right: 8px;
            top: 8px;
            padding: 3px 6px;
            border-radius: 8px;
            font-size: 12px;
            background: var(--prac);
            color: #000
        }
        
        .pair.upcoming {
            border: 2px solid var(--green)
        }
        
        @media (max-width:1100px) {
            .cards {
                grid-template-columns: repeat(2, 1fr)
            }
        }
        
        @media (max-width:680px) {
            .cards {
                grid-template-columns: 1fr
            }
        }
    </style>
</head>

<body>
    <div class="wrap">
        <div class="topbar">
            <div>
                <div class="brand">–†–æ–∑–∫–ª–∞–¥ ‚Äî 4 –∫—É—Ä—Å, –≥—Ä—É–ø–∞ –í</div>
                <div class="muted">–î–≤–æ—Ç–∏–∂–Ω–µ–≤–∏–π (–ü–Ω‚Äì–ü—Ç)</div>
            </div>
            <div class="top-right">
                <button id="toggleTheme" class="btn">–¢–µ–º–∞</button>
                <button id="todayBtn" class="btn">–°—å–æ–≥–æ–¥–Ω—ñ</button>
                <div class="controls">
                    <button id="prevWeek" class="btn">‚óÄ</button>
                    <div style="min-width:90px;text-align:center"><strong id="weekLabel">–ù–∏–∂–Ω—ñ–π</strong></div>
                    <button id="nextWeek" class="btn">‚ñ∂</button>
                </div>
            </div>
        </div>

        <div class="grid cards" id="weekGrid"></div>
    </div>

    <script>
        const DAYS = ['mon', 'tue', 'wed', 'thu', 'fri'];
        const DAY_NAMES = {
            mon: '–ü–Ω',
            tue: '–í—Ç',
            wed: '–°—Ä',
            thu: '–ß—Ç',
            fri: '–ü—Ç'
        };

        const defaultData = {
            settings: {
                theme: 'dark',
                baseTopWeekISO: '2025-09-01',
                perDay: 6
            },
            times: [{
                start: '08:00',
                end: '09:20'
            }, {
                start: '09:30',
                end: '10:50'
            }, {
                start: '11:00',
                end: '12:20'
            }, {
                start: '12:40',
                end: '14:00'
            }, {
                start: '14:10',
                end: '15:30'
            }, {
                start: '15:40',
                end: '17:00'
            }],
            template: {
                top: {
                    mon: [null, {
                        type: 'lec',
                        title: '–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–µ —Å—É–¥–æ—á–∏–Ω—Å—Ç–≤–æ',
                        teacher: '–°—É—à–∫–æ –û.–û.',
                        place: '–°–æ–±–æ—Ä–Ω–∞, 48'
                    }, {
                        type: 'lec',
                        title: '–ì–æ—Å–ø–æ–¥–∞—Ä—Å—å–∫–µ –ø—Ä–∞–≤–æ',
                        teacher: '–ö–∞–ª–∞—á–µ–Ω–∫–æ–≤–∞ –ö.–û.',
                        place: '304'
                    }, {
                        type: 'lec',
                        title: '–ö—Ä–∏–º—ñ–Ω–∞–ª—ñ—Å—Ç–∏–∫–∞',
                        teacher: '–ö–∞–≤—É–Ω –°.–ú.',
                        place: '313'
                    }],
                    tue: [null, null, null, null, {
                        type: 'lec',
                        title: '–°–û–ü ‚Äî –õ—ñ–¥–µ—Ä—Å—Ç–≤–æ —Ç–∞ –∫–æ–º–∞–Ω–¥–æ—É—Ç–≤–æ—Ä–µ–Ω–Ω—è',
                        teacher: '–°–µ—Ä–µ–¥–∞ –ì.–í.',
                        place: 'MS Teams'
                    }, {
                        type: 'prac',
                        title: '–°–û–ü ‚Äî –õ—ñ–¥–µ—Ä—Å—Ç–≤–æ —Ç–∞ –∫–æ–º–∞–Ω–¥–æ—É—Ç–≤–æ—Ä–µ–Ω–Ω—è',
                        teacher: '–°–µ—Ä–µ–¥–∞ –ì.–í.',
                        place: 'MS Teams'
                    }],
                    wed: [null, {
                        type: 'text',
                        title: '–î–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞ –∑ –ø–µ—Ä–µ–ª—ñ–∫—É'
                    }],
                    thu: [null, null, null, {
                        type: 'lec',
                        title: '–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–µ –ø—Ä–∞–≤–æ',
                        teacher: '–î–æ—Ä–æ—à–µ–Ω–∫–æ –õ.–ú.',
                        place: '304'
                    }, {
                        type: 'lec',
                        title: '–ó–µ–º–µ–ª—å–Ω–µ –ø—Ä–∞–≤–æ',
                        teacher: '–ë–∞—Ö—É—Ä –û.–í.',
                        place: '305'
                    }, {
                        type: 'lec',
                        title: '–§—ñ–Ω–∞–Ω—Å–æ–≤–µ –ø—Ä–∞–≤–æ',
                        teacher: '–ü–µ—Ç—Ä–µ–Ω–∫–æ –ì.–û.',
                        place: '305'
                    }],
                    fri: [null, {
                        type: 'prac',
                        title: '–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–µ —Å—É–¥–æ—á–∏–Ω—Å—Ç–≤–æ',
                        teacher: '–°—É—à–∫–æ –û.–û.',
                        place: '–°–æ–±–æ—Ä–Ω–∞, 48'
                    }, {
                        type: 'prac',
                        title: '–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–µ –ø—Ä–∞–≤–æ',
                        teacher: '–î–æ—Ä–æ—à–µ–Ω–∫–æ –õ.–ú.',
                        place: '121'
                    }, {
                        type: 'prac',
                        title: '–§—ñ–Ω–∞–Ω—Å–æ–≤–µ –ø—Ä–∞–≤–æ',
                        teacher: '–ü–µ—Ç—Ä–µ–Ω–∫–æ –ì.–û.',
                        place: '305'
                    }, {
                        type: 'prac',
                        title: '–ö—Ä–∏–º—ñ–Ω–∞–ª—ñ—Å—Ç–∏–∫–∞',
                        teacher: '–ö–∞–≤—É–Ω –°.–ú.',
                        place: '313'
                    }]
                },
                bottom: {
                    mon: [null, {
                        type: 'lec',
                        title: '–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–µ —Å—É–¥–æ—á–∏–Ω—Å—Ç–≤–æ',
                        teacher: '–°—É—à–∫–æ –û.–û.',
                        place: '–°–æ–±–æ—Ä–Ω–∞, 48'
                    }, {
                        type: 'lec',
                        title: '–ì–æ—Å–ø–æ–¥–∞—Ä—Å—å–∫–µ –ø—Ä–∞–≤–æ',
                        teacher: '–ö–∞–ª–∞—á–µ–Ω–∫–æ–≤–∞ –ö.–û.',
                        place: '304'
                    }],
                    tue: [null, null, null, null, {
                        type: 'lec',
                        title: '–°–û–ü ‚Äî –õ—ñ–¥–µ—Ä—Å—Ç–≤–æ —Ç–∞ –∫–æ–º–∞–Ω–¥–æ—É—Ç–≤–æ—Ä–µ–Ω–Ω—è',
                        teacher: '–°–µ—Ä–µ–¥–∞ –ì.–í.',
                        place: 'MS Teams'
                    }, {
                        type: 'prac',
                        title: '–°–û–ü ‚Äî –õ—ñ–¥–µ—Ä—Å—Ç–≤–æ —Ç–∞ –∫–æ–º–∞–Ω–¥–æ—É—Ç–≤–æ—Ä–µ–Ω–Ω—è',
                        teacher: '–°–µ—Ä–µ–¥–∞ –ì.–í.',
                        place: 'MS Teams'
                    }],
                    wed: [null, {
                        type: 'text',
                        title: '–î–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞ –∑ –ø–µ—Ä–µ–ª—ñ–∫—É'
                    }],
                    thu: [null, null, null, {
                        type: 'lec',
                        title: '–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–µ –ø—Ä–∞–≤–æ',
                        teacher: '–î–æ—Ä–æ—à–µ–Ω–∫–æ –õ.–ú.',
                        place: '304'
                    }, {
                        type: 'lec',
                        title: '–ó–µ–º–µ–ª—å–Ω–µ –ø—Ä–∞–≤–æ',
                        teacher: '–ë–∞—Ö—É—Ä –û.–í.',
                        place: '305'
                    }, {
                        type: 'prac',
                        title: '–ó–µ–º–µ–ª—å–Ω–µ –ø—Ä–∞–≤–æ',
                        teacher: '–ë–∞—Ö—É—Ä –û.–í.',
                        place: '307'
                    }],
                    fri: [null, {
                        type: 'prac',
                        title: '–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–µ —Å—É–¥–æ—á–∏–Ω—Å—Ç–≤–æ',
                        teacher: '–°—É—à–∫–æ –û.–û.',
                        place: '–°–æ–±–æ—Ä–Ω–∞, 48'
                    }, {
                        type: 'prac',
                        title: '–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–µ –ø—Ä–∞–≤–æ',
                        teacher: '–î–æ—Ä–æ—à–µ–Ω–∫–æ –õ.–ú.',
                        place: '121'
                    }, {
                        type: 'prac',
                        title: '–ì–æ—Å–ø–æ–¥–∞—Ä—Å—å–∫–µ –ø—Ä–∞–≤–æ',
                        teacher: '–ö–∞–ª–∞—á–µ–Ω–∫–æ–≤–∞ –ö.–û.',
                        place: '121'
                    }]
                }
            }
        };

        let currentMonday = mondayOf(new Date());
        const grid = document.getElementById('weekGrid');

        function applyTheme() {
            document.body.setAttribute('data-theme', data.settings.theme === 'light' ? 'light' : 'dark');
        }
        let data = defaultData;
        applyTheme();

        document.getElementById('toggleTheme').onclick = () => {
            data.settings.theme = data.settings.theme === 'light' ? 'dark' : 'light';
            applyTheme();
        };

        function mondayOf(date) {
            const d = new Date(date);
            const day = (d.getDay() + 6) % 7;
            d.setDate(d.getDate() - day);
            d.setHours(0, 0, 0, 0);
            return d;
        }

        function isTopWeek(date) {
            const base = mondayOf(new Date(data.settings.baseTopWeekISO));
            const cur = mondayOf(new Date(date));
            const diffWeeks = Math.round((cur - base) / (7 * 24 * 3600 * 1000));
            return diffWeeks % 2 === 0;
        }

        function sameDay(d1, d2) {
            return d1.getFullYear() === d2.getFullYear() &&
                d1.getMonth() === d2.getMonth() &&
                d1.getDate() === d2.getDate();
        }

        function parseTimeToDate(timeStr, baseDate) {
            if (!timeStr) return null;
            const [h, m] = timeStr.split(':').map(Number);
            const d = new Date(baseDate);
            d.setHours(h, m || 0, 0, 0);
            return d;
        }

        function getTimeFor(dayKey, pairIndex) {
            let idx = pairIndex;
            if (dayKey === 'mon' && pairIndex >= 1) idx = pairIndex + 1;
            return data.times[idx] || {
                start: '',
                end: ''
            };
        }

        function getPairsForDay(dayKey, date) {
            const week = isTopWeek(date) ? 'top' : 'bottom';
            return data.template[week][dayKey] || [];
        }

        function render() {
            grid.innerHTML = '';
            const top = isTopWeek(currentMonday);
            document.getElementById('weekLabel').textContent = top ? '–í–µ—Ä—Ö–Ω—ñ–π' : '–ù–∏–∂–Ω—ñ–π';

            const now = new Date();
            const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
            const viewingCurrentWeek = mondayOf(today).getTime() === currentMonday.getTime();

            for (let i = 0; i < DAYS.length; i++) {
                const dKey = DAYS[i];
                const card = document.createElement('div');
                card.className = 'card';
                const dayDate = new Date(currentMonday.getTime() + i * 86400000);

                if (viewingCurrentWeek && sameDay(dayDate, today)) card.classList.add('now');

                const head = document.createElement('div');
                head.className = 'head';
                head.innerHTML = `<div><div class="day">${DAY_NAMES[dKey]}</div>
                          <div class="dateSmall">${dayDate.toLocaleDateString('uk-UA',{day:'2-digit',month:'2-digit'})}</div></div>`;
                card.appendChild(head);

                const pairs = getPairsForDay(dKey, dayDate);
                const visible = pairs.map((p, idx) => ({
                    p,
                    idx
                })).filter(x => x.p);

                if (visible.length === 0) {
                    const empty = document.createElement('div');
                    empty.className = 'muted';
                    empty.textContent = '–í—ñ–ª—å–Ω–∏–π –¥–µ–Ω—å üéâ';
                    card.appendChild(empty);
                    grid.appendChild(card);
                    continue;
                }

                let currentIdx = -1,
                    nextIdx = -1;
                if (viewingCurrentWeek && sameDay(dayDate, today)) {
                    for (const v of visible) {
                        const t = getTimeFor(dKey, v.idx);
                        const st = parseTimeToDate(t.start, today);
                        const en = parseTimeToDate(t.end, today);
                        if (st && en && now >= st && now <= en) {
                            currentIdx = v.idx;
                            break;
                        }
                    }
                    if (currentIdx !== -1) {
                        for (const v of visible) {
                            if (v.idx > currentIdx) {
                                nextIdx = v.idx;
                                break;
                            }
                        }
                    } else {
                        for (const v of visible) {
                            const t = getTimeFor(dKey, v.idx);
                            const st = parseTimeToDate(t.start, today);
                            if (st && st > now) {
                                nextIdx = v.idx;
                                break;
                            }
                        }
                    }
                }

                for (const v of visible) {
                    const p = v.p;
                    const t = getTimeFor(dKey, v.idx);
                    const box = document.createElement('div');
                    box.className = 'pair';
                    if (viewingCurrentWeek && sameDay(dayDate, today)) {
                        if (v.idx === currentIdx) box.classList.add('current');
                        if (v.idx === nextIdx && currentIdx !== -1) {
                            box.classList.add('next');
                            const badge = document.createElement('div');
                            badge.className = 'badge';
                            badge.textContent = '–ù–∞—Å—Ç—É–ø–Ω–∞';
                            box.appendChild(badge);
                        }
                        if (v.idx === nextIdx && currentIdx === -1) box.classList.add('upcoming');
                    }
                    const chip = p.type === 'lec' ? `<span class="chip lec">–õ–µ–∫—Ü—ñ—è</span>` :
                        p.type === 'prac' ? `<span class="chip prac">–ü—Ä–∞–∫—Ç–∏–∫–∞</span>` : `<span class="chip">–Ü–Ω—Ñ–æ</span>`;
                    box.innerHTML += `<div class="meta"><div>${t.start}‚Äì${t.end}</div>${chip}</div>
                            <h4>${p.title}</h4>
                            <div class="muted">${p.teacher || ''}${p.place ? ' ‚Ä¢ ' + p.place : ''}</div>`;
                    card.appendChild(box);
                }
                grid.appendChild(card);
            }

            // –∞–≤—Ç–æ—Å–∫—Ä–æ–ª –Ω–∞ —Å—å–æ–≥–æ–¥–Ω—ñ
            if (viewingCurrentWeek) {
                const todayCard = document.querySelector('.card.now');
                if (todayCard) todayCard.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        }

        document.getElementById('prevWeek').onclick = () => {
            currentMonday.setDate(currentMonday.getDate() - 7);
            render();
        };
        document.getElementById('nextWeek').onclick = () => {
            currentMonday.setDate(currentMonday.getDate() + 7);
            render();
        };
        document.getElementById('todayBtn').onclick = () => {
            currentMonday = mondayOf(new Date());
            render();
        };

        render();
    </script>
</body>

</html>